{% extends 'student_layout.html.twig' %}

{% block title %}Mes Modules - EduSmart{% endblock %}

{% block body %}
    <div style="padding: 0 var(--sp-4);">
        <h2 style="font-size: 1.8rem; font-weight: 800; margin-bottom: var(--sp-6); color: #1E293B;">Mes Modules</h2>
        
        <div style="margin-bottom: var(--sp-6); position: relative;">
            <i class="fas fa-search" style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #94A3B8;"></i>
            <input type="text" id="moduleSearch" placeholder="Rechercher un module..." style="width: 100%; padding: 12px 12px 12px 45px; border: 1px solid #E2E8F0; border-radius: 12px; outline: none; transition: border-color 0.2s; font-size: 1rem;">
        </div>

        {% if modules is empty %}
            <div class="card" style="text-align: center; padding: 50px; color: #64748B;">
                <i class="fas fa-book-open" style="font-size: 3rem; margin-bottom: 20px; color: #CBD5E1;"></i>
                <p>Aucun module disponible pour le moment.</p>
            </div>
        {% else %}
            <div id="modulesGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                {% for module in modules %}
                    <a href="{{ path('student_module_details', {id: module.id}) }}" style="text-decoration: none; color: inherit;" class="fade-in stagger-{{ loop.index0 % 3 + 1 }} module-link" data-title="{{ module.title|lower }}">
                        <div class="card module-card hover-scale glow-effect" style="padding: 0; overflow: hidden; height: 100%; transition: all 0.3s ease; border: 1px solid #E2E8F0;">
                            <div style="height: 160px; background: #F1F5F9; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative;">
                                {% if module.thumbnail %}
                                    <img src="{{ asset('uploads/' ~ module.thumbnail) }}" alt="{{ module.title }}" style="width: 100%; height: 100%; object-fit: cover;">
                                {% else %}
                                    <i class="fas fa-layer-group" style="font-size: 3rem; color: #CBD5E1;"></i>
                                {% endif %}
                            </div>
                            <div style="padding: 20px;">
                                <h3 style="font-size: 1.1rem; font-weight: 700; margin-bottom: 10px; color: #1E293B;">{{ module.title }}</h3>
                                <p style="font-size: 0.9rem; color: #64748B; line-height: 1.5; margin-bottom: 20px; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;">
                                    {{ module.description }}
                                </p>
                                <div style="display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #F1F5F9; padding-top: 15px;">
                                    <span style="font-size: 0.8rem; color: #6366F1; font-weight: 600;">
                                        {{ module.courses|length }} Cour(s)
                                    </span>
                                    <span class="btn btn-outline" style="padding: 5px 12px; font-size: 0.8rem;">Voir les cours</span>
                                </div>
                            </div>
                        </div>
                    </a>
                {% endfor %}
            </div>
        {% endif %}
    </div>

    <script>
        document.getElementById('moduleSearch').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const modules = document.querySelectorAll('.module-link');
            
            modules.forEach(module => {
                const title = module.getAttribute('data-title');
                if (title.includes(searchTerm)) {
                    module.style.display = 'block';
                } else {
                    module.style.display = 'none';
                }
            });
        });
    </script>
{% endblock %}
